@import "tailwindcss";

/* Theme tokens using @theme directive */
@theme {
  /* Typography - reference next/font variables */
  --font-serif: var(--font-fraunces), ui-serif, Georgia, serif;
  --font-sans: var(--font-open-sans), ui-sans-serif, system-ui, sans-serif;
  --font-sketch: var(--font-sketch), 'Comic Sans MS', cursive;
  --font-mono: var(--font-mono), 'IBM Plex Mono', ui-monospace, monospace;

  /* Fluid Type Scale */
  --text-display: clamp(2.5rem, 5vw + 1rem, 4.5rem);
  --text-h1: clamp(2rem, 3vw + 1rem, 3rem);
  --text-h2: clamp(1.5rem, 2vw + 0.75rem, 2rem);
  --text-h3: clamp(1.25rem, 1.5vw + 0.75rem, 1.5rem);
  --text-body: clamp(1rem, 0.5vw + 0.875rem, 1.125rem);
  --text-small: clamp(0.875rem, 0.25vw + 0.8rem, 0.9375rem);

  /* Color Palette: Workshop at Golden Hour (Dark Mode Only) */
  /* Base: Warm slate with blue undertones - lifted for better contrast */
  --color-base-950: oklch(0.18 0.015 250);
  --color-base-900: oklch(0.22 0.015 250);
  --color-base-800: oklch(0.30 0.012 250);
  --color-base-700: oklch(0.40 0.010 250);
  --color-base-600: oklch(0.52 0.008 250);

  /* Accent: Golden honey amber */
  --color-amber-600: oklch(0.68 0.16 70);
  --color-amber-500: oklch(0.75 0.15 72);
  --color-amber-400: oklch(0.82 0.13 74);
  --color-amber-300: oklch(0.88 0.10 76);

  /* Text: Warm cream with deeper tone */
  --color-text-primary: oklch(0.92 0.022 80);
  --color-text-secondary: oklch(0.75 0.016 80);
  --color-text-muted: oklch(0.58 0.010 250);

  /* Layered Shadows: Subtle, tinted with base color */
  --shadow-color: oklch(0.08 0.015 250);

  --shadow-sm:
    0 1px 3px oklch(0.08 0.015 250 / 0.08),
    0 2px 6px oklch(0.05 0.01 250 / 0.05);

  --shadow-md:
    0 2px 4px oklch(0.08 0.015 250 / 0.06),
    0 4px 12px oklch(0.05 0.01 250 / 0.08),
    0 8px 24px oklch(0.03 0.008 250 / 0.06);

  --shadow-lg:
    0 4px 8px oklch(0.08 0.015 250 / 0.05),
    0 8px 20px oklch(0.05 0.01 250 / 0.08),
    0 16px 40px oklch(0.03 0.008 250 / 0.10);

  /* Spacing (using Tailwind defaults, extend if needed) */
  --spacing-section: clamp(4rem, 8vw, 8rem);

  /* Border Radius */
  --radius-sm: 0.375rem;
  --radius-md: 0.5rem;
  --radius-lg: 0.75rem;
  --radius-xl: 1.75rem;

  /* Container */
  --container-max: 72rem;
  --container-padding: clamp(1rem, 4vw, 2rem);
}

/* Base layer for global defaults */
@layer base {
  html {
    font-family: var(--font-sans);
    color: var(--color-text-primary);
    background-color: var(--color-base-950);
    scroll-behavior: smooth;
  }

  body {
    min-height: 100dvh;
    line-height: 1.6;
    -webkit-font-smoothing: antialiased;
  }

  /* Typography defaults */
  h1, h2, h3, h4, h5, h6 {
    font-family: var(--font-serif);
    line-height: 1.2;
    font-weight: 400;
  }

  h1 { font-size: var(--text-h1); }
  h2 { font-size: var(--text-h2); }
  h3 { font-size: var(--text-h3); }

  p {
    font-size: var(--text-body);
    max-width: 65ch;
  }
}

/* Page entrance fade-in animation */
@keyframes page-fade-in {
  from { opacity: 0; }
  to   { opacity: 1; }
}

.animate-page-fade {
  animation: page-fade-in 0.5s ease-out both;
}

/* Paper grain texture overlay component
   Uses feTurbulence with low frequency for organic, paper-like fiber texture
   rather than harsh digital noise. Combined with feColorMatrix for contrast. */
@layer components {
  .grain-overlay {
    position: relative;
  }

  .grain-overlay::before {
    content: '';
    position: fixed;
    inset: 0;
    z-index: 9999;
    pointer-events: none;
    opacity: 0.08;
    mix-blend-mode: overlay;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='paper'%3E%3CfeTurbulence type='turbulence' baseFrequency='0.04' numOctaves='5' stitchTiles='stitch' result='noise'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23paper)'/%3E%3C/svg%3E");
    background-size: 256px 256px;
  }

  /* Card-specific paper grain - slightly more visible on elevated surfaces */
  .card-grain {
    position: relative;
    overflow: hidden;
  }

  .card-grain::before {
    content: '';
    position: absolute;
    inset: 0;
    z-index: 1;
    pointer-events: none;
    opacity: 0.1;
    mix-blend-mode: overlay;
    border-radius: inherit;
    background-image: url('/textures/paper-texture.jpg');
    background-size: cover;
    background-position: center;
  }

  /* Custom shadow utilities for dark backgrounds
     Uses subtle light glow with higher blur radius
     for soft, modern elevation effect. */
  .shadow-elevation-sm {
    box-shadow:
      0 1px 4px rgba(255, 255, 255, 0.02),
      0 4px 16px rgba(255, 255, 255, 0.02);
  }

  .shadow-elevation-md {
    box-shadow:
      0 2px 6px rgba(255, 255, 255, 0.025),
      0 8px 24px rgba(255, 255, 255, 0.03);
  }

  .shadow-elevation-lg {
    box-shadow:
      0 4px 10px rgba(255, 255, 255, 0.03),
      0 12px 36px rgba(255, 255, 255, 0.04);
  }

  /* Hover variants */
  .hover\:shadow-elevation-md:hover {
    box-shadow:
      0 2px 6px rgba(255, 255, 255, 0.025),
      0 8px 24px rgba(255, 255, 255, 0.03);
  }

  .hover\:shadow-elevation-lg:hover {
    box-shadow:
      0 4px 10px rgba(255, 255, 255, 0.03),
      0 12px 36px rgba(255, 255, 255, 0.04);
  }

  /* Rich markdown article body styles for /updates/[slug] detail pages */
  .prose-updates {
    font-family: var(--font-sans);
    font-size: 16px;
    color: #C4B89A;
    line-height: 1.75;
  }

  .prose-updates p {
    margin-bottom: 1.25em;
    max-width: 65ch;
  }

  .prose-updates h2 {
    font-family: var(--font-serif);
    font-size: 28px;
    font-weight: 700;
    color: #EDE5D4;
    margin-top: 2em;
    margin-bottom: 0.75em;
    line-height: 1.3;
  }

  .prose-updates h3 {
    font-family: var(--font-serif);
    font-size: 22px;
    font-weight: 600;
    color: #EDE5D4;
    margin-top: 1.5em;
    margin-bottom: 0.5em;
    line-height: 1.4;
  }

  .prose-updates blockquote {
    border-left: 3px solid #D4A843;
    padding-left: 1em;
    margin: 1.5em 0;
    font-style: italic;
    color: var(--color-text-muted);
  }

  .prose-updates blockquote p {
    margin-bottom: 0.5em;
  }

  .prose-updates ul {
    list-style: none;
    padding-left: 1.25em;
    margin: 1em 0;
  }

  .prose-updates ul li {
    position: relative;
    padding-left: 0.25em;
    margin-bottom: 0.5em;
  }

  .prose-updates ul li::before {
    content: '';
    position: absolute;
    left: -1em;
    top: 0.65em;
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background-color: #D4A843;
  }

  .prose-updates ol {
    list-style: none;
    padding-left: 1.25em;
    margin: 1em 0;
    counter-reset: list-counter;
  }

  .prose-updates ol li {
    position: relative;
    padding-left: 0.25em;
    margin-bottom: 0.5em;
    counter-increment: list-counter;
  }

  .prose-updates ol li::before {
    content: counter(list-counter) '.';
    position: absolute;
    left: -1.5em;
    color: #D4A843;
    font-weight: 600;
    font-size: 14px;
  }

  /* Code blocks (rehype-pretty-code output) */
  .prose-updates pre {
    position: relative;
    background-color: #0D0F14;
    border-radius: 8px;
    margin: 1.5em 0;
    overflow: hidden;
  }

  .prose-updates pre > code {
    display: block;
    padding: 1em 1.25em;
    font-family: var(--font-mono);
    font-size: 13px;
    line-height: 1.6;
    overflow-x: auto;
  }

  .prose-updates [data-rehype-pretty-code-figure] {
    position: relative;
  }

  .prose-updates [data-rehype-pretty-code-title] {
    background-color: #0D0F14;
    border-bottom: 1px solid #2D3140;
    padding: 0.5em 1.25em;
    font-family: var(--font-mono);
    font-size: 12px;
    color: var(--color-text-muted);
    border-radius: 8px 8px 0 0;
  }

  .prose-updates [data-rehype-pretty-code-title] + pre {
    border-radius: 0 0 8px 8px;
  }

  /* Inline code */
  .prose-updates :not(pre) > code {
    background-color: #1A1D26;
    color: #D4A843;
    padding: 0.15em 0.4em;
    border-radius: 4px;
    font-family: var(--font-mono);
    font-size: 13px;
  }

  /* Copy button for code blocks (injected via useEffect in EntryArticle) */
  .prose-updates pre .copy-button {
    position: absolute;
    top: 0.5em;
    right: 0.5em;
    background: #2D3140;
    border: 1px solid #3D4150;
    border-radius: 4px;
    padding: 0.25em 0.5em;
    font-family: var(--font-mono);
    font-size: 11px;
    color: var(--color-text-muted);
    cursor: pointer;
    opacity: 0;
    transition: opacity 0.15s;
  }

  .prose-updates pre:hover .copy-button {
    opacity: 1;
  }

  .prose-updates pre .copy-button:hover {
    color: var(--color-text-primary);
    background: #3D4150;
  }

  /* Images */
  .prose-updates img {
    max-width: 100%;
    border-radius: 8px;
    border: 1px solid #2D3140;
    margin: 1.5em 0 0.5em;
  }

  .prose-updates img + em,
  .prose-updates figcaption {
    display: block;
    font-style: italic;
    color: var(--color-text-muted);
    font-size: 14px;
    margin-bottom: 1.5em;
  }

  /* Horizontal rules */
  .prose-updates hr {
    border: none;
    border-top: 1px solid #2D3140;
    margin: 2em 0;
  }

  /* Links */
  .prose-updates a {
    color: #D4A843;
    text-decoration: underline;
    text-underline-offset: 2px;
    transition: color 0.15s;
  }

  .prose-updates a:hover {
    color: #E8C060;
  }

  /* Emphasis */
  .prose-updates strong {
    color: #EDE5D4;
    font-weight: 600;
  }

  .prose-updates em {
    font-style: italic;
  }
}


/* Utility for text that "sinks into" the page */
@layer utilities {
  .text-sink {
    text-shadow: 0 1px 0 oklch(0.08 0.01 250 / 0.5);
  }

  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
}
