---
phase: 10-page-shell
plan: 02
type: execute
wave: 2
depends_on: ["10-01"]
files_modified:
  - src/app/updates/page.tsx
  - src/components/updates/UpdatesPageContent.tsx
  - src/components/updates/NowSection.tsx
  - src/components/updates/EntryStreamContainer.tsx
autonomous: true

must_haves:
  truths:
    - "Visiting /updates renders a full page with heading, now section, and entry stream"
    - "Page heading switches between 'Updates' and 'Mises a jour' when locale changes"
    - "Now section displays current focus and learning in the active locale"
    - "Page source contains proper title and meta description SEO tags"
    - "Entry stream shows all entries from getUpdates() as minimal placeholders"
  artifacts:
    - path: "src/app/updates/page.tsx"
      provides: "Route handler with generateMetadata and server data fetching"
      exports: ["default", "generateMetadata"]
    - path: "src/components/updates/UpdatesPageContent.tsx"
      provides: "Client component orchestrating the page layout"
      contains: "use client"
    - path: "src/components/updates/NowSection.tsx"
      provides: "Bilingual now section hero"
      contains: "use client"
    - path: "src/components/updates/EntryStreamContainer.tsx"
      provides: "Minimal entry list placeholder for Phase 11"
      contains: "use client"
  key_links:
    - from: "src/app/updates/page.tsx"
      to: "src/lib/now.ts"
      via: "getNow() import"
      pattern: "import.*getNow.*from.*lib/now"
    - from: "src/app/updates/page.tsx"
      to: "src/lib/updates.ts"
      via: "getUpdates() import"
      pattern: "import.*getUpdates.*from.*lib/updates"
    - from: "src/app/updates/page.tsx"
      to: "src/components/updates/UpdatesPageContent.tsx"
      via: "passes now + entries as props"
      pattern: "UpdatesPageContent.*now=.*entries="
    - from: "src/components/updates/NowSection.tsx"
      to: "messages/en.json"
      via: "useTranslations hook for labels"
      pattern: "t\\(.*updates\\.now"
---

<objective>
Build the /updates page route and all client components: page heading, NowSection hero, and EntryStreamContainer placeholder.

Purpose: This creates the complete page shell that visitors navigate to. Phase 11 will replace the minimal entry rendering with styled UpdateCards. Phase 12 adds tag filtering.
Output: Working /updates route with SEO metadata, bilingual page chrome, now section hero, and a bare-bones entry stream.
</objective>

<execution_context>
@/Users/lucasalexander/.claude/get-shit-done/workflows/execute-plan.md
@/Users/lucasalexander/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-page-shell/10-01-SUMMARY.md
@src/lib/updates.ts
@src/lib/i18n.tsx
@src/app/layout.tsx
@src/app/globals.css
@messages/en.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create the /updates route with generateMetadata</name>
  <files>src/app/updates/page.tsx</files>
  <action>
Create `src/app/updates/page.tsx` as a React Server Component that:

1. **generateMetadata** (named export):
   - Imports `getNow` from `@/lib/now`
   - Reads `now.focus_en` to build a dynamic meta description
   - Returns `{ title: 'Updates | Civix Solutions', description: 'Currently focused on: ${now.focus_en}', openGraph: { title, description } }`
   - Metadata is EN-only (locale is client-side state, inaccessible in RSC -- this matches the rest of the site)

2. **Default export** (page component):
   - Imports and calls `getNow()` from `@/lib/now`
   - Imports and calls `await getUpdates()` from `@/lib/updates`
   - Imports `UpdatesPageContent` from `@/components/updates/UpdatesPageContent`
   - Renders `<UpdatesPageContent now={now} entries={entries} />`
   - The page.tsx itself has NO UI markup -- it's purely a data-fetching shell that passes props to the client component

The server/client split is critical: page.tsx is RSC (for generateMetadata + data fetching), UpdatesPageContent is 'use client' (for locale-reactive rendering via useTranslations).
  </action>
  <verify>
`npx tsc --noEmit` passes. The file exports both `generateMetadata` and a default component.
  </verify>
  <done>
/updates route exists, fetches data server-side, and delegates all rendering to UpdatesPageContent.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create UpdatesPageContent, NowSection, and EntryStreamContainer</name>
  <files>src/components/updates/UpdatesPageContent.tsx, src/components/updates/NowSection.tsx, src/components/updates/EntryStreamContainer.tsx</files>
  <action>
Create three 'use client' components in `src/components/updates/`:

**UpdatesPageContent.tsx:**
- Props: `{ now: NowEntry, entries: UpdateEntry[] }` (import types from `@/lib/now` and `@/lib/updates`)
- Uses `useTranslations()` from `@/lib/i18n` for the page heading
- Layout: narrow reading column using `max-w-3xl mx-auto px-6 py-12`
- Renders:
  1. `<h1>` with `t('updates.pageTitle')` -- uses font-serif class for Fraunces, text size `text-h1` (the CSS variable from globals.css)
  2. `<NowSection now={now} />`
  3. `<EntryStreamContainer entries={entries} />`
- Background: the root layout already provides `bg-base-950` on body, so NO background wrapper needed on this component. The page content sits directly on the base background.

**NowSection.tsx:**
- Props: `{ now: NowEntry }`
- Uses `useLocale()` from `@/lib/i18n` for locale, `useTranslations()` for labels
- Selects `focus_en`/`focus_fr` and `learning_en`/`learning_fr` based on current locale
- Formats the `now.updated` date using `toLocaleDateString()` with locale-appropriate formatting (en-CA or fr-CA, month + year only: `{ year: 'numeric', month: 'long' }`)
- IMPORTANT: Date formatting happens client-side (this is a 'use client' component), so `new Date(now.updated)` is safe here -- no RSC prerender mismatch
- Visual styling -- a subtle card that acts as the page hero:
  - `mb-12 p-6 rounded-lg` for shape
  - Use `bg-base-900` for the surface (one step lighter than the page background `base-950`)
  - Use `border border-base-800` for a subtle border
  - Labels: `text-xs font-semibold uppercase tracking-widest text-amber-500` (golden accent color)
  - Content text: `text-text-primary` (default body text)
  - Updated date: `text-xs text-text-muted`
  - Two fields displayed vertically with `space-y-3` gap

**EntryStreamContainer.tsx:**
- Props: `{ entries: UpdateEntry[] }`
- This is the Phase 11 handoff placeholder -- renders a BARE data render (not empty div) to prove data flows end-to-end
- Maps over entries, rendering each as:
  ```
  <div key={entry.slug} className="py-4 border-b border-base-800">
    <p className="text-sm text-text-muted">{entry.title}</p>
  </div>
  ```
- Wraps in `<section aria-label="Updates stream">` for accessibility
- This minimal rendering will be replaced by UpdateCard in Phase 11

**CSS variable usage** -- use the Tailwind 4 theme tokens from globals.css:
- `base-950` (page bg), `base-900` (surface), `base-800` (borders)
- `amber-500` (accent labels), `amber-400` (lighter accent if needed)
- `text-primary` (body text), `text-secondary` (dimmer text), `text-muted` (subtle text)
- Shadow classes: `shadow-elevation-sm` for subtle card elevation
- Font: headings use `font-serif` (Fraunces), body uses `font-sans` (Open Sans) by default

Do NOT use generic CSS variables like `--bg`, `--surface`, `--border`, `--accent` -- those do not exist in this project. Use the actual Tailwind 4 theme token class names listed above.
  </action>
  <verify>
Run `npx tsc --noEmit` -- all files compile. Then run `npm run build` to confirm the /updates route builds successfully as a server component with proper metadata.
  </verify>
  <done>
- /updates renders page heading that switches between EN/FR
- NowSection displays focus and learning content in the active locale with translated labels
- EntryStreamContainer shows all 4 seed entries by title
- Page source includes correct title and meta description tags
- Build succeeds with no errors
  </done>
</task>

</tasks>

<verification>
- `npm run build` succeeds with /updates route in the output
- View page source at /updates contains `<title>Updates | Civix Solutions</title>`
- View page source contains meta description with "Currently focused on"
- Page heading displays "Updates" in EN locale
- NowSection shows current focus and learning content
- EntryStreamContainer renders 4 entry titles
- Switching locale changes heading to "Mises a jour" and NowSection labels/content to French
</verification>

<success_criteria>
- /updates route is a working server component with generateMetadata
- Page chrome (heading, now section labels) is fully bilingual
- Now section reads from now.md and displays in active locale
- Entry stream renders all entries from getUpdates()
- Build passes with zero errors
</success_criteria>

<output>
After completion, create `.planning/phases/10-page-shell/10-02-SUMMARY.md`
</output>
