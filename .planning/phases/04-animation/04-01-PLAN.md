---
phase: 04-animation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/motion/MotionProvider.tsx
  - src/lib/motion.ts
  - src/app/layout.tsx
  - package.json
autonomous: true

must_haves:
  truths:
    - "Motion library is installed and available"
    - "All motion components respect prefers-reduced-motion"
    - "m component is used instead of motion for bundle optimization"
  artifacts:
    - path: "src/components/motion/MotionProvider.tsx"
      provides: "LazyMotion wrapper with domMax features and MotionConfig"
      exports: ["MotionProvider"]
    - path: "src/lib/motion.ts"
      provides: "Shared animation variants and transitions"
      exports: ["springSubtle", "springSnappy", "fadeUpVariants", "staggerContainerVariants", "cardHoverVariants", "buttonTapVariants"]
  key_links:
    - from: "src/app/layout.tsx"
      to: "src/components/motion/MotionProvider.tsx"
      via: "Component wrapping children"
      pattern: "<MotionProvider>"
---

<objective>
Install Motion library and establish animation infrastructure with LazyMotion bundle optimization and accessibility support.

Purpose: Foundation for all subsequent animation work. Ensures consistent motion personality ("smooth & measured") and proper reduced-motion handling across the entire app.

Output: MotionProvider component wrapping app, shared variants/transitions in lib/motion.ts
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-animation/04-CONTEXT.md
@.planning/phases/04-animation/04-RESEARCH.md
@src/app/layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Motion and create shared infrastructure</name>
  <files>
    - package.json
    - src/components/motion/MotionProvider.tsx
    - src/lib/motion.ts
  </files>
  <action>
1. Install motion library:
   ```bash
   npm install motion
   ```

2. Create `src/components/motion/MotionProvider.tsx`:
   - 'use client' directive (required for motion)
   - Import `LazyMotion`, `domMax`, `MotionConfig` from 'motion/react'
   - Export `MotionProvider` component that wraps children in:
     - `LazyMotion features={domMax} strict` (strict catches accidental full imports)
     - `MotionConfig reducedMotion="user"` (respects OS preference)

3. Create `src/lib/motion.ts` with shared variants:
   - Import `Variants`, `Transition` types from 'motion/react'
   - `springSubtle`: type: 'spring', stiffness: 400, damping: 30 (minimal overshoot)
   - `springSnappy`: type: 'spring', stiffness: 500, damping: 25 (button press)
   - `durationStandard`: 0.3 (250-350ms range)
   - `durationSlow`: 0.5 (typewriter completion)
   - `fadeUpVariants`: hidden {opacity: 0, y: 20}, visible {opacity: 1, y: 0, transition: durationStandard, ease: 'easeOut'}
   - `staggerContainerVariants`: hidden {}, visible {transition: staggerChildren: 0.08}
   - `cardHoverVariants`: rest {y: 0}, hover {y: -4, transition: springSubtle}
   - `buttonTapVariants`: rest {scale: 1}, tap {scale: 0.97, transition: springSnappy}

Note: Shadow animations will be added via Tailwind classes, not motion variants (better performance).
  </action>
  <verify>
    - `npm list motion` shows motion@12.x installed
    - `ls src/components/motion/MotionProvider.tsx` exists
    - `ls src/lib/motion.ts` exists
    - Files compile without TypeScript errors: `npx tsc --noEmit`
  </verify>
  <done>
    Motion package installed. MotionProvider exports working component. lib/motion.ts exports all shared variants.
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate MotionProvider into app layout</name>
  <files>
    - src/app/layout.tsx
  </files>
  <action>
1. Read current `src/app/layout.tsx`

2. Import `MotionProvider` from '@/components/motion/MotionProvider'

3. Wrap the `{children}` inside the body with `<MotionProvider>`:
   ```tsx
   <body className="bg-base-950 text-text-primary">
     <MotionProvider>
       {children}
     </MotionProvider>
   </body>
   ```

Note: MotionProvider is a client component, but wrapping server components in a client boundary is fine - only the provider renders client-side, children can still be server components initially.
  </action>
  <verify>
    - `grep -q "MotionProvider" src/app/layout.tsx` returns 0
    - App still renders without errors (check dev server if running)
    - No hydration mismatches in browser console
  </verify>
  <done>
    App layout wraps all pages in MotionProvider. LazyMotion features available to all components.
  </done>
</task>

</tasks>

<verification>
1. Motion infrastructure:
   - `npm list motion` shows version 12.x
   - `cat src/components/motion/MotionProvider.tsx` contains LazyMotion, domMax, MotionConfig
   - `cat src/lib/motion.ts` contains springSubtle, fadeUpVariants, staggerContainerVariants

2. Integration:
   - `grep "MotionProvider" src/app/layout.tsx` shows import and usage
   - TypeScript compiles: `npx tsc --noEmit`
</verification>

<success_criteria>
- Motion library installed at version 12.x
- MotionProvider wraps app with LazyMotion (domMax) and MotionConfig (reducedMotion: "user")
- Shared variants exported from lib/motion.ts
- App layout properly wrapped
- No TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/04-animation/04-01-SUMMARY.md`
</output>
